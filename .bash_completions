#!/bin/bash

foreman_run() {
  words=`cat Procfile | cut -d ':' -f1`
  if [[ $3 = start ]]; then
    COMPREPLY=( $(compgen -W "$words" $2) )
  else
    COMPREPLY=( $(compgen -W "$(ls -A)" $2) )
  fi
}
complete -F foreman_run foreman

npm_run() {
  words=`node<<-NODE
    const scripts = require('./package.json').scripts
    const list = Object.keys(scripts).join(' ')
    console.log(list)
NODE`

  if [[ $3 = run ]]; then
    COMPREPLY=( $(compgen -W "$words" $2) )
  else
    COMPREPLY=( $(compgen -W "$(ls -A)" $2) )
  fi
}
complete -F npm_run npm
